# ğŸ§  AI System Architecture

**Gear Lab Pro** utilizes a bi-level AI architecture: a **Low-Level Heuristic Optimization Swarm** and a **High-Level Generative Reasoning Layer**.

---

## ğŸ—ï¸ The Solver Race (Layer 1)

Instead of relying on a single algorithm, we launch a **Solver Race Hub**. This orchestrates multiple optimization agents in parallel:

1.  **Exploration Agent (Annealing)**: Casts a wide net across the gearbox configuration space.
2.  **Convergence Agent (PSO)**: Rapidly refines the most promising candidates.
3.  **Refinement Agent (Genetic)**: Evolves the candidate set through biologically-inspired crossovers.

### ğŸ”¹ Deterministic Validation
Every solution generated by the "Brain" is run through a **Physics Sandbox** (`src/lib/physics.ts`). If a configuration fails a mechanical constraint (e.g., exceeds RPM redline), it is instantly penalized with a "Killer Fitness" score, ensuring the AI never recommends a physically destructive setup.

---

## ğŸ™ï¸ Pit Wall Reasoning (Layer 2)

We integrate **Google Gemini Pro** to act as a bridge between raw data and human decision-making.

### ğŸ”¹ Retrieval-Augmented Telemetry (RAT)
The system feeds the following context to Gemini:
- **Kinematic State**: Final 1D/2D time deltas.
- **Anomaly Detection**: Identifying torque saturation (traction loss) or "dead-spots" in gear transitions.
- **Constraints**: Vehicle weight, engine torque limits, and tire $\mu$.

### ğŸ”¹ The Force-Heuristic Fallback
To ensure **Trackside Resilience**, we implemented a proprietary fallback system. If the Gemini API is inaccessible (low bandwidth at the track), a **Deterministic Reasoner** takes over. It uses rule-based logic to evaluate:
- **RPM Drops**: Assessing if gear-spacing causes the engine to fall out of the power band.
- **Traction Percentage**: Calculating % of lap spent at the limit of adhesion.

---

## ğŸ“‚ Data Topology

- **State Management**: Using `TanStack Query` to handle asynchronous solver states.
- **Persistence**: `IndexedDB` for local storage of optimization runs, enabling "Long-Term Memory" without a server backend.
- **UI Sync**: High-frequency updates ($60$ FPS) from the optimization progress to the `React` state for real-time visual feedback.
